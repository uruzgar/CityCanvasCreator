<!DOCTYPE html>
<html>
<head>
    <title>Erişilebilirlik Haritası</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        #map { height: 768px; width: 1024px; left: 240px;}
        .controls { padding: 10px; background: white; position: absolute; z-index: 1000; top: 10px; left: 10px; border-radius: 5px; box-shadow: 0 2px 5px rgba(0,0,0,0.2); }
    </style>
</head>
<body>

<div class="controls">
    <label>Süre Seçin:</label>
    <select id="duration">
        <option value="900">15 dk</option>
        <option value="1800">30 dk</option>
        <option value="3600">1 saat</option>
        <option value="7200">2 saat</option>
    </select>
    <button onclick="getIsochrone()">Göster</button>
    <p><small>Haritaya tıklayarak nokta seçin</small></p>
</div>

<div id="map"></div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
    const map = L.map('map').setView([41.0082, 28.9784], 11); // İstanbul merkezli
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);

    let selectedCoords = null;
    let marker = null;
    let isochroneLayer = null;

    // Haritaya tıklayınca konum seçme
    map.on('click', function(e) {
        selectedCoords = [e.latlng.lng, e.latlng.lat];
        if (marker) map.removeLayer(marker);
        marker = L.marker(e.latlng).addTo(map);
    });

    async function getIsochrone() {
        if (!selectedCoords) return alert("Lütfen önce haritadan bir nokta seçin!");
        
        const duration = document.getElementById('duration').value;
        const apiKey = 'YOUR_API_KEY'; // Buraya API anahtarınızı koyun
        
        const url = `https://api.openrouteservice.org/v2/isochrones/driving-car`;
        const body = {
            locations: [selectedCoords],
            range: [duration]
        };

        const response = await fetch(url, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'Authorization': 'eyJvcmciOiI1YjNjZTM1OTc4NTExMTAwMDFjZjYyNDgiLCJpZCI6IjIzMjViMWZjZTg5MzRhNmM4NGIyYjRlNWFmOWUzODE3IiwiaCI6Im11cm11cjY0In0='
            },
            body: JSON.stringify(body)
        });

        const data = await response.json();
        
        if (isochroneLayer) map.removeLayer(isochroneLayer);
        isochroneLayer = L.geoJSON(data, {
            style: {
			color: '#3498db',      // Çizgi rengi (Mavi)
			fillColor: '#3498db',  // Dolgu rengi
			fillOpacity: 0.4,      // Şeffaflık (0 ile 1 arası)
			weight: 1              // Kenar çizgisi kalınlığı
			}
        }).addTo(map);
        
        map.fitBounds(isochroneLayer.getBounds());
    }
</script>
</body>
</html>